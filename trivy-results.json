{
  "SchemaVersion": 2,
  "CreatedAt": "2025-08-27T13:26:10.794027+03:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "RepoURL": "git@github.com:pab1it0/prometheus-mcp-server.git",
    "Branch": "main",
    "Commit": "83e2fbedd5f795fba24335a635da5808e50d073f",
    "CommitMsg": "feat: Add Docker MCP registry compliance and comprehensive testing\n\nThis major enhancement adds full Docker MCP registry compliance and\ncomprehensive testing infrastructure for containerized deployments:\n\n## Docker MCP Registry Compliance\n- Created server.yaml configuration for Docker MCP registry submission\n- Enhanced Dockerfile with OCI labels and registry standards\n- Added health check mechanism for container orchestration\n- Optimized multi-stage build with security best practices\n\n## Enhanced Container Features\n- Non-root user execution (UID 1000) for security\n- Comprehensive environment variable validation\n- Support for all transport modes (stdio, HTTP, SSE)\n- Production-ready resource limits and health checks\n\n## Comprehensive Testing Suite\n- Docker integration tests with multiple scenarios\n- MCP protocol compliance validation tests\n- Container security and permission verification\n- Transport mode and authentication testing\n- Error handling and edge case coverage\n\n## Documentation \u0026 Deployment\n- Complete Docker deployment guide with examples\n- Production deployment configurations\n- Docker Compose templates for various scenarios\n- Kubernetes deployment manifests\n- Security best practices and troubleshooting\n\n## Key Improvements\n- Added health_check MCP tool for container monitoring\n- Enhanced error handling with structured logging\n- Improved configuration validation and startup checks\n- Added dependency management for testing (docker, requests)\n- Registry-compliant metadata and labeling\n\nThis change enables submission to Docker's MCP registry while\nmaintaining backward compatibility and adding robust testing\ninfrastructure for production deployments.\n\nðŸ¤– Generated with [Claude Code](https://claude.ai/code)\n\nCo-Authored-By: Claude \u003cnoreply@anthropic.com\u003e",
    "Author": "pab1it0 \u003cpavel@cloudefined.com\u003e",
    "Committer": "pab1it0 \u003cpavel@cloudefined.com\u003e"
  },
  "Results": [
    {
      "Target": "Python",
      "Class": "lang-pkgs",
      "Type": "python-pkg"
    },
    {
      "Target": "uv.lock",
      "Class": "lang-pkgs",
      "Type": "uv",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2025-43859",
          "PkgID": "h11@0.14.0",
          "PkgName": "h11",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/h11@0.14.0",
            "UID": "487fcbd62615479a"
          },
          "InstalledVersion": "0.14.0",
          "FixedVersion": "0.16.0",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-43859",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "h11: h11 accepts some malformed Chunked-Encoding bodies",
          "Description": "h11 is a Python implementation of HTTP/1.1. Prior to version 0.16.0, a leniency in h11's parsing of line terminators in chunked-coding message bodies can lead to request smuggling vulnerabilities under certain conditions. This issue has been patched in version 0.16.0. Since exploitation requires the combination of buggy h11 with a buggy (reverse) proxy, fixing either component is sufficient to mitigate this issue.",
          "Severity": "CRITICAL",
          "CweIDs": [
            "CWE-444"
          ],
          "VendorSeverity": {
            "ghsa": 4,
            "redhat": 3,
            "ubuntu": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
              "V3Score": 9.1
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
              "V3Score": 7.4
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-43859",
            "https://github.com/python-hyper/h11",
            "https://github.com/python-hyper/h11/commit/114803a29ce50116dc47951c690ad4892b1a36ed",
            "https://github.com/python-hyper/h11/security/advisories/GHSA-vqfr-h8mv-ghfj",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-43859",
            "https://ubuntu.com/security/notices/USN-7503-1",
            "https://www.cve.org/CVERecord?id=CVE-2025-43859"
          ],
          "PublishedDate": "2025-04-24T19:15:47.06Z",
          "LastModifiedDate": "2025-04-29T13:52:28.49Z"
        },
        {
          "VulnerabilityID": "CVE-2025-47273",
          "PkgID": "setuptools@76.1.0",
          "PkgName": "setuptools",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/setuptools@76.1.0",
            "UID": "98d781341d8f6e4a"
          },
          "InstalledVersion": "76.1.0",
          "FixedVersion": "78.1.1",
          "Status": "fixed",
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-47273",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "setuptools: Path Traversal Vulnerability in setuptools PackageIndex",
          "Description": "setuptools is a package that allows users to download, build, install, upgrade, and uninstall Python packages. A path traversal vulnerability in `PackageIndex` is present in setuptools prior to version 78.1.1. An attacker would be allowed to write files to arbitrary locations on the filesystem with the permissions of the process running the Python code, which could escalate to remote code execution depending on the context. Version 78.1.1 fixes the issue.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-22"
          ],
          "VendorSeverity": {
            "alma": 2,
            "amazon": 3,
            "azure": 3,
            "bitnami": 3,
            "ghsa": 3,
            "nvd": 3,
            "oracle-oval": 2,
            "photon": 3,
            "redhat": 2,
            "rocky": 2,
            "ubuntu": 2
          },
          "CVSS": {
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 8.8
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:L",
              "V3Score": 7.1
            }
          },
          "References": [
            "https://access.redhat.com/errata/RHSA-2025:13578",
            "https://access.redhat.com/security/cve/CVE-2025-47273",
            "https://bugzilla.redhat.com/2366982",
            "https://bugzilla.redhat.com/show_bug.cgi?id=2366982",
            "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-47273",
            "https://errata.almalinux.org/9/ALSA-2025-13578.html",
            "https://errata.rockylinux.org/RLSA-2025:11036",
            "https://github.com/pypa/advisory-database/tree/main/vulns/setuptools/PYSEC-2025-49.yaml",
            "https://github.com/pypa/setuptools",
            "https://github.com/pypa/setuptools/blob/6ead555c5fb29bc57fe6105b1bffc163f56fd558/setuptools/package_index.py#L810C1-L825C88",
            "https://github.com/pypa/setuptools/commit/250a6d17978f9f6ac3ac887091f2d32886fbbb0b",
            "https://github.com/pypa/setuptools/issues/4946",
            "https://github.com/pypa/setuptools/security/advisories/GHSA-5rjg-fvgr-3xxf",
            "https://linux.oracle.com/cve/CVE-2025-47273.html",
            "https://linux.oracle.com/errata/ELSA-2025-9940.html",
            "https://lists.debian.org/debian-lts-announce/2025/05/msg00035.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-47273",
            "https://ubuntu.com/security/notices/USN-7544-1",
            "https://www.cve.org/CVERecord?id=CVE-2025-47273"
          ],
          "PublishedDate": "2025-05-17T16:15:19.11Z",
          "LastModifiedDate": "2025-06-12T16:29:01.66Z"
        }
      ]
    }
  ]
}
